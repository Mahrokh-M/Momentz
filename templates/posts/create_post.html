{% extends 'base.html' %}
{% load static %}

{% block title %}Create Post - Momentz{% endblock %}

{% block content %}
<div class="container mx-auto p-4 max-w-2xl">
    <div class="cyber-card p-6">
        <h1 class="text-2xl font-bold text-neon-cyan mb-6 glitch-effect" data-text="CREATE POST">CREATE POST</h1>
        
        {% if messages %}
        <div class="mb-6 space-y-2">
            {% for message in messages %}
            <div class="cyber-alert {% if message.tags %}{{ message.tags }}{% endif %}">
                {{ message }}
                <button class="close-btn" onclick="this.parentElement.remove()">âœ•</button>
            </div>
            {% endfor %}
        </div>
        {% endif %}
        
        <form method="post" enctype="multipart/form-data" class="space-y-4">
            {% csrf_token %}
            <div class="cyber-form-group">
                <label for="content" class="text-neon-purple">WHAT'S ON YOUR MIND?</label>
                <textarea name="content" id="content" class="cyber-textarea" rows="5" required></textarea>
            </div>
            
            <div class="cyber-form-group">
                <label for="image_url" class="text-neon-purple">IMAGE URL (OPTIONAL)</label>
                <input type="text" name="image_url" id="image_url" class="cyber-input">
            </div>
            
            <div class="cyber-form-group">
                <label class="cyber-upload-btn">
                    <span class="text-neon-cyan">OR UPLOAD IMAGE</span>
                    <input type="file" name="image" id="image" accept="image/*" class="hidden">
                </label>
                <div id="image-preview" class="hidden mt-2"></div>
            </div>
            
            <button type="submit" class="cyber-btn w-full mt-6">
                <i class="fas fa-paper-plane mr-2"></i> POST
            </button>
        </form>
    </div>
</div>

<script>
document.getElementById('image').addEventListener('change', function(e) {
    const preview = document.getElementById('image-preview');
    if (this.files && this.files[0]) {
        const reader = new FileReader();
        preview.classList.remove('hidden');
        reader.onload = function(e) {
            preview.innerHTML = `<img src="${e.target.result}" class="max-w-full h-auto border border-neon-cyan">`;
        }
        reader.readAsDataURL(this.files[0]);
    }
});
</script>

<style>
.cyber-form-group {
    margin-bottom: 1.5rem;
}

.cyber-textarea {
    background-color: rgba(10, 10, 20, 0.8);
    border: 1px solid var(--neon-cyan);
    color: var(--neon-cyan);
    width: 100%;
    padding: 1rem;
    border-radius: 0;
    resize: vertical;
}

.cyber-upload-btn {
    display: inline-block;
    padding: 0.5rem 1rem;
    border: 1px dashed var(--neon-purple);
    cursor: pointer;
    transition: all 0.3s ease;
}

.cyber-upload-btn:hover {
    background-color: rgba(255, 0, 255, 0.1);
}

.cyber-alert {
    position: relative;
    padding: 1rem;
    border-left: 4px solid var(--neon-cyan);
    background-color: rgba(10, 10, 30, 0.8);
}

.cyber-alert.error {
    border-left-color: var(--neon-pink);
}

.close-btn {
    position: absolute;
    top: 0.5rem;
    right: 0.5rem;
    background: none;
    border: none;
    color: var(--neon-cyan);
    cursor: pointer;
}
</style>
{% endblock %}