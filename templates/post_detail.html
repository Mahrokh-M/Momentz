<div class="post-actions mb-3">
    <form action="{% url 'posts:like' post.post_id %}" method="post" class="like-form d-inline" data-post-id="{{ post.post_id }}">
        {% csrf_token %}
        <button type="submit" class="btn btn-sm btn-{% if post.is_liked %}danger{% else %}outline-danger{% endif %}" id="like-btn-{{ post.post_id }}">
            {% if post.is_liked %}Unlike{% else %}Like{% endif %} (<span id="like-count-{{ post.post_id }}">{{ post.like_count }}</span>)
        </button>
    </form>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
$(document).ready(function() {
    $('.like-form').on('submit', function(e) {
        e.preventDefault();
        var form = $(this);
        var postId = form.data('post-id');
        
        $.ajax({
            url: form.attr('action'),
            type: 'POST',
            data: form.serialize(),
            dataType: 'json',
            success: function(response) {
                if (response.success) {
                    $('#like-count-' + postId).text(response.like_count);
                    var btn = $('#like-btn-' + postId);
                    if (response.is_liked) {
                        btn.removeClass('btn-outline-danger').addClass('btn-danger').text('Unlike (' + response.like_count + ')');
                    } else {
                        btn.removeClass('btn-danger').addClass('btn-outline-danger').text('Like (' + response.like_count + ')');
                    }
                }
            },
            error: function(xhr) {
                alert('Error: ' + xhr.responseJSON.message || 'An error occurred');
            }
        });
    });
});
</script>