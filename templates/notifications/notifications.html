{% extends 'base.html' %}

  {% block title %}Notifications - Momentz{% endblock %}

  {% block content %}
  <div class="container mt-4">
      <h2 class="mb-4 text-2xl font-bold text-gray-800">Notifications</h2>

      {% if messages %}
          {% for message in messages %}
              <div class="alert alert-{{ message.tags }}">{{ message }}</div>
          {% endfor %}
      {% endif %}

      <div class="mb-4 flex justify-between items-center">
          <p class="text-gray-600">
              You have <span class="font-semibold text-indigo-600">{{ unread_count }}</span> unread notification{{ unread_count|pluralize }}.
          </p>
          {% if notifications %}
          <form method="post" action="{% url 'notifications:notifications' %}">
              {% csrf_token %}
              <button type="submit" class="btn btn-outline-primary text-sm">Mark All as Read</button>
          </form>
          {% endif %}
      </div>

      {% if notifications %}
          <div class="space-y-4">
              {% for notification in notifications %}
              <div class="card {% if not notification.is_read %}bg-indigo-50{% else %}bg-white{% endif %} shadow-md rounded-lg p-4 flex items-start space-x-3">
                  <div class="flex-1">
                      <p class="text-gray-800">
                          <a href="{% url 'users:profile' notification.related_user_username %}" class="text-indigo-600 font-semibold hover:underline">
                              {{ notification.related_user_username }}
                          </a>
                          {{ notification.content|slice:"1:"|lower }}
                      </p>
                      <div class="text-sm text-gray-500 mt-1">
                          {{ notification.created_at|date:"F j, Y, g:i a" }}
                      </div>
                      {% if notification.related_post_id %}
                      <div class="mt-2">
                          <a href="{% url 'posts:post_detail' notification.related_post_id %}" class="text-indigo-600 text-sm hover:underline">
                              View Post
                          </a>
                      </div>
                      {% endif %}
                  </div>
                  {% if not notification.is_read %}
                  <span class="inline-block w-3 h-3 bg-indigo-600 rounded-full"></span>
                  {% endif %}
              </div>
              {% endfor %}
          </div>
      {% else %}
          <p class="text-gray-600">No notifications to display.</p>
      {% endif %}
  </div>
  {% endblock %}